% !TEX TS-program = arara
% arara: xelatex: { synctex: on, options: [--halt-on-error] } 
%% arara: biber
%% arara: makeglossaries
%% arara: makeindex
%% arara: xelatex: { synctex: on, options: [-halt-on-error] } 
%% arara: xelatex: { synctex: on, options: [-halt-on-error] } 
%%       arara: clean: { files: [tikzcd.aux,tikzcd.bbl] }
% arara: clean: { files: [tikzcd.bcf,tikzcd.blg] }
% arara: clean: { files: [tikzcd.glg,tikzcd.glo] }
% arara: clean: { files: [tikzcd.gls,tikzcd.gls] }
% arara: clean: { files: [tikzcd.idx,tikzcd.ilg] }
% arara: clean: { files: [tikzcd.ind,tikzcd.loe] }
% arara: clean: { files: [tikzcd.lof,tikzcd.log] }
% arara: clean: { files: [tikzcd.log,tikzcd.lol] }
% arara: clean: { files: [tikzcd.out,tikzcd.thm] }
% arara: clean: { files: [tikzcd.run.xml] }
% arara: clean: { files: [tikzcd.toc,tikzcd.xdy] }
% arara: clean: { files: [tikzcd.synctex.gz] }
%-------------------------------------------------------------------------------
\documentclass[11pt,openany]{article}
\usepackage{import}
\def \texFolder {../../tex/}
\def \bibFolder {../../bib/}
\def \sharedFolder {../../shared/}
\import{\texFolder}{head}
\import{\texFolder}{landscape-2col-8x17}
\import{\texFolder}{clj-listings}
\import{\sharedFolder}{glossary}
%-----------------------------------------------------------------
\title{Notes on category \\ and topos theory}
\author{\textsc{John Alan McDonald}}
%\email{mcdonald.john.alan at gmail.com}
\date{draft of \today}
%-----------------------------------------------------------------
\begin{document}

% Note tkzcd bug: bounding box for diagram includes the control 
% pts of the curved edges! 
%\begin{figure}
%\centering

before
\begin{figure}
\centering
\begin{tikzcd}[row sep=1.2cm, column sep=2.5cm,
execute at begin picture={
          \useasboundingbox (-5.1,-3.5) rectangle (5.1,3.5);
         }
         ]
V_0
\arrow[loop above, blue, crossing over]
\arrow[drr, bend left=40, "e_{02}" near start]
\arrow[ddr, bend right=40, "e_{03}"' near start]
\arrow[dr, "{e_{01}}" ] 
\arrow[drr, "e_{12} \circ e_{01}", bend left=10, dashed, red]
\arrow[ddr, "e_{13} \circ e_{01}", bend right=10, dashed, red]
\arrow[loop right, blue, crossing over]
& & 
\\
& V_1 
\arrow[loop above, blue,crossing over]
\arrow[r, "e_{12}"] 
\arrow[d, "e_{13}"']
\arrow[dr, bend left, "e_{24} \circ e_{12}", dashed, red]
\arrow[dr, bend right, "e_{34} \circ e_{13}"' red, dashed, red]
& V_2 
\arrow[loop right, crossing over, blue]
\arrow[d, "e_{24}"] 
\\
& V_3 
\arrow[loop below, blue,crossing over]
\arrow[r, "e_{34}"']
& V_4
\arrow["e_{24} \circ e_{02}" {near end},
from=1-1,to=3-3, red, dashed, bend left=100,]
\arrow["e_{34} \circ e_{03}"' {near end},
from=1-1,to=3-3, red, dashed, bend right=100,]
\arrow["e_{24} \circ e_{12} \circ e_{01}" {near start},
from=1-1,to=3-3, draw=DarkGreen, dashed, bend left=120]
\arrow["e_{34} \circ e_{13} \circ e_{01}"' {near start},
from=1-1,to=3-3, draw=DarkGreen, dashed, bend right=120]
\end{tikzcd}
\caption{Completion of fig.~\ref{fig:a_digraph}
to a category}
\label{fig:a_completed_digraph}
\end{figure}

after
\end{document}
