% jam 2004-09-10

\section{Maps between vector spaces}
\label{sec:maps}

In general, the functions discussed here map between real inner product spaces:
$\f:\vspace \mapsto \Space{W}$, where $\vspace$ is the
{\it domain} and $\Space{W}$ is the {\it codomain}.
The real inner product spaces are almost derived from some $\Reals^n$.

The {\it range} of $\f$, $\range(f)$, is the set $\f(\vspace)$,
which may be a proper subset of its codomain $\Space{W}$.
The {\it kernel} of $\f$, $\kernel(f)$, is the set
$\kernel(\f) = \{ \v \in \vspace : \f(\v) = \0 \}$.

I often use the words `map' and `function' interchangeably.
When I want to distinguish between real- and vector-valued functions,
I may use 'map' for vector-valued functions and
'function' for real-valued ones.

I use $\Space{U}$, $\vspace$, $\Space{W}$ for generic vector spaces,
$\u$, $\v$, $\w$, etc., for elements of vector spaces,
and
$\f$, $\g$, $\h$ for vector-valued maps/functions.
I generally do not distinguish $\Reals$, the real numbers,
and $\Reals^1$, or any other 1-dimensional real vector space.
I sometimes use $f$, $g$, $h$ for extra clarity in the special
case of real-valued functions.

The domains of many interesting functions,
such as those that depend on vertex positions,
are direct sum of inner product spaces.
The {\it direct sum} $\vspace \oplus \Space{W}$ is the inner product space
consisting of the ordered pairs $\{ (\v,\w) : \v \in \vspace, \w \in \Space{W} \}$
inheriting the inner product space operations in the obvious way:
$(\v_0,\w_0) \bullet (\v_1,\w_1) = (\v_0 \bullet \v_1) + (\w_0 \bullet \w_1).$
I will usually write an element of $\oplus^n \vspace$ as
$(\v_0,\ldots,\v_{n-1})$
and use
$\f(\v_0,\v_1,\ldots,\v_{n-1})$
for a function that depends on $n$ vectors.

%--------------------------------------------------------------------

\subsection{Linear maps}
\label{sec:linear-maps}

A map $\Lmap(\v):\vspace \mapsto \Space{W}$
is {\it linear} iff
$\Lmap(a_0 \v_0 + a_1 \v_1) = a_0 \Lmap(\v_0) + a_1 \Lmap(\v_1)$.
I will often write $\Lmap\v \equiv \Lmap(\v)$.

Its not hard to see that, for a linear map,
the range and kernel are linear subspaces of the codomain and
domain, respectively.
Thus any linear map between inner product spaces
divides its domain and codomain each into 2 orthogonal subspaces.
The domain is divided into $\vspace = \kernel(\Lmap) \oplus \kernel^{\perp}(\Lmap)$,
and the codomain is divided into $\Space{W} = \range(\Lmap) \oplus \range^{\perp}(\Lmap)$.

The most common representation for linear maps is the {\it matrix:}
Let $\Lmap(\v):\vspace \mapsto \Space{W}$ be linear,
$\{ \e_0^{\vspace} \ldots  \e_{m-1}^{\vspace} \}$ an orthonormal basis for $\vspace$,
and
$\{ \e_0^{\Space{W}} \ldots \e_{n-1}^{\Space{W}} \}$ an orthonormal  basis for $\Space{W}$
Then $\Lmap$ can be expressed as
\begin{equation}
\Lmap
 =
\sum_{i=0}^{m-1} \sum_{j=0}^{n-1} L_{ij} ( \e_i^{\Space{W}} \otimes \e_j^{\vspace} )
\end{equation}
$(L_{ij})$ is the matrix representation of $\Lmap$ with respect to
the two bases\cite{Halmos:1958:Finite}.

It is important to note that there are many usful
representations for linear maps other than matrices \cite{McDonald:1989:OOPSLA}.
Sometimes other representations are used for convenience,
or to enforce some constraint like symmetry.
In some cases, a non-matrix representation must be used,
because a particular linear transformation
cannot be accurately represented by a matrix of floating point numbers.

Examples:

\begin{itemize}

\item Column-wise:
$\Lmap = \sum_{j=0}^{n-1} ( \c_j^{\Lmap} \otimes \e_j^{\vspace} )$

$\c_j^{\Lmap} \in \Space{W}$ are the 'columns' of $\Lmap$.
$\linear_span\{ \c_0^{\Lmap} \ldots \c_{n-1}^{\Lmap} \} = \range(\Lmap)$
(see \autoref{sec:spans-and-projections}).

\item Row-wise:
$\Lmap = \sum_{i=0}^{m-1} ( \e_i^{\Space{W}} \otimes  \r_i^{\Lmap} )$

$\r_i^{\Lmap} \in \vspace$ are the 'rows' of $\Lmap$.
$\linear_span\{ \r_0^{\Lmap} \ldots \r_{m-1}^{\Lmap} \} =  \kernel(\Lmap)^{\perp}$
(see \autoref{sec:spans-and-projections}).

\item Householder:
$\h_{\v} = \Identity_{\vspace} - \frac{2}{\| \v \|^2} (\v \otimes \v)$

Householder maps are usually chosen to zero the elements of
a vector, or a row or column of a matrix, for a contiguous range of
indices, say, $[i_0,\ldots,i_n)$.

\end {itemize}

%--------------------------------------------------------------------

\subsection{Affine maps}
\label{sec:affine-maps}

A function $\Amap(\v):\vspace \mapsto \Space{W}$
is {\it affine} if distributes over affine combinations:
$\Amap(\sum_{i=0}^{n-1} a_i \v_i) = \sum_{i=0}^{n-1} a_i \Amap(\v_i) $
for all $\{a_i\}$ such that $1 = \sum_{i=0}^{n-1} a_i$.
(Note that I am describing affine maps on vector (linear) spaces,
rather than the slightly more general notion of affine maps on affine spaces.)
Any linear map between vector spaces is automatically affine.
The other major class of affine maps on vector spaces are the translations.
A {\it translation,} $\Tmap_{\t}$, $\vspace \mapsto \vspace$,
simply adds a vector ($\t$) to its argument:
$\Tmap_{\t} \v = \v + \t$.
It's not hard to see that any affine map between two vector spaces
can be represented as the sum of a linear map and a translation.
A typical representation for a general affine map $\Amap : \vspace \mapsto \Space{W}$
is as a pair $(\Lmap,\t)$ where $\Lmap : \vspace \mapsto \Space{W}$ is linear,
$\t \in \Space{W}$, and $\Amap(\v) = \Lmap(\v) + \t$.

%--------------------------------------------------------------------

\subsection{Spans and projections}
\label{sec:spans-and-projections}

Let $\vspace$ be an $n$-dimensional inner product space.

The {\it linear span} of a set of $m$ vectors in $\vspace$
is the set of linear combinations of those vectors:
\begin{equation}
\linear_span\{ \v_0 \ldots \v_{m-1} \} = \{\v \in \vspace : \v = \sum_{i=0}^{m-1} a_i \v_i\}
\end{equation}
$\linear_span\{ \v_0 \ldots \v_{m-1} \}$ is a linear subspace of $\vspace$.

The {\it projection} $\Projection_{\Sset} \v$ of a vector $\v \in \vspace$
onto an arbitrary subset $\Sset \subset \vspace$
is the closest point in $\Sset$ to $\v$.
Projection onto a linear subspace is a linear map and
can be computed by summing
elementary orthogonal projections onto an orthonormal basis for the subspace.

An orthonormal basis for $\linear_span\{ \v_0 \ldots \v_{m-1} \}$
(and $\linear_span\{ \v_0 \ldots \v_{m-1} \}^\perp$)
can be computed using the QR decomposition
of the map $\Vmap = \sum_{i=0}^{m-1} \v_i \otimes \e_i$,
(the $n \times m$ matrix whose columns are the $\v_i$).
See Golub and Van Loan~\cite[sec.~5.2]{GolubVanLoan:1996}.

The {\it affine span} of a set of $m+1$ vectors in $\vspace$
is the set of affine combinations of those vectors:
\begin{equation}
\affinespan\{ \p_0 \ldots \p_{m} \} = \{\v \in \vspace : \v = \sum_{i=0}^{m} b_i \p_i;
1 = \sum_{i=0}^{m} b_i \}.
\end{equation}
$\affinespan\{ \p_0 \ldots \p_{m} \}$ is an affine subspace of $\vspace$.
$\b = ( b_0 \ldots b_m )$ are {\it barycentric coordinates}
for $\v$ with respect to $\{ \p_0 \ldots \p_{m} \}$.
The barycentric coordinates are unique if $\{ \p_0 \ldots \p_{m} \}$
are affinely independent.

Any affine subspace, $\Space{A}$, of a vector space, $\vspace$ can be represented as
as a translation of a linear subspace of $\vspace$:
$\Space{A} = \Space{T}(\Space{A}) + \t$,
$\Space{T}(\Space{A})$ is the set of differences of elements of $\Space{A}$,
a linear subspace of $\vspace$.
If $\t$ is any element of $\Space{A}$.
then projection onto $\Space{A}$
can be computed as a translation of an orthogonal projection onto $\Space{T}(\Space{A})$:
$\Projection_{\Space{A}} (\p) = \t + \Projection_{\Space{T}(\Space{A})} (\p - \t)$.
Typically, we pick $\t$ to be the smallest element of $\Space{A}$.
Projection onto an affine space is clearly an affine map.

We can represent the affine span of a set of $m+1$ vectors
as a translation of a linear span:
\begin{equation}
\affinespan\{ \p_0 \ldots \p_{m} \} = \p_m + \linear_span\{\v_0 \ldots \v_{m-1}\}
\end{equation}
where $\v_i = \p_i - \p_m$,
which allows us to compute the projection onto
$\affinespan\{ \p_0 \ldots \p_{m} \}$
again using the QR decomposition
of $\Vmap = \sum_{i=0}^{m-1} \v_i \otimes \e_i$.

%--------------------------------------------------------------------

\subsection{Inverses and pseudo-inverses}
\label{sec:Inverses-and-pseudo-inverses}

A convenient definition for the {\it true inverse}
of a map $\f(\v):\vspace \mapsto \Space{W}$ is
$\f^{-1}(\w) = \{ \v : \f(\v) = \w \}$.
The usual definition of inverse treats $\f^{-1}$
as a map from $\Space{W} \mapsto \vspace$,
which is undefined where the value of the true
inverse is not a set containing a single point.

For maps between inner product spaces,
the {\it pseudo-inverse}, $f^{-}$, is a map $\Space{W} \mapsto \vspace$
defined everywhere on $\Space{W}$.
Let $\hat{\w}$ be an element of $\Space{W}$ closest to $\w$
such that $\f^{-1}(\w)$ is not empty.
Let $\hat{\v}$ be a minimum norm element of $\f^{-1}(\hat{\w})$.
Then $\f^{-}(\w) = \hat{\v}$.

If $\Lmap$ is linear, then it's not hard to see that
$\hat{\w} = \pi_{\range(\Lmap)} \w$, the projection of $\w$
on the range of $\Lmap$
and
$\hat{\v}$ is the unique element of $\kernel^{\perp}(\Lmap)$
such that $\Lmap(\hat{\v}) = \hat{\w}$.

The pseudo-inverse of a linear map can be characterized
by the four Moore-Penrose conditions
(see Golub and Van Loan\cite[sec.~5.5.4]{GolubVanLoan:1996}):
\begin{enumerate}
\item $\Lmap \Lmap^{-} \Lmap = \Lmap$
\item $\Lmap^{-} \Lmap \Lmap^{-} = \Lmap^{-}$
\item $\left( \Lmap \Lmap^{-} \right)^{\dagger} = \Lmap \Lmap^{-}$
\item $\left( \Lmap^{-} \Lmap \right)^{\dagger} = \Lmap^{-} \Lmap$
\end{enumerate}

When the 'columns' of $\Lmap$, $\r_j^{\Lmap}$
($\Lmap = \sum_{j=0}^{n-1} ( \Lmap_j^{\Space{W}} \otimes \e_j^{\vspace} )$)
are linearly independent,
then a useful identity is:
\begin{equation}
\label{eq:full-rank-pseudo-inverse}
\Lmap^{-} = \left( \Lmap^{\dagger} \Lmap \right)^{-1} \Lmap^{\dagger}
\end{equation}

The pseudoinverse can be computed
using standard matrix decompositions such as
the QR and SVD \cite{GolubVanLoan:1996}.
The pseudoinverse is an example of a linear transformation
which should {\em not} be represented by a matrix
\cite{McDonald:1989:OOPSLA}.

If $\Amap$ is affine,
let $\Amap = \Lmap + \t$,
where $\Lmap$ is linear,
and $\t$ is an element of $\range(\Amap)$.
Then $\Amap^{-}(\w) = \Lmap^{-}( \w - \t )$.

%--------------------------------------------------------------------


