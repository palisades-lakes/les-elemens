%-------------------------------------------------------------------------------
\errorcontextlines 10000
%-------------------------------------------------------------------------------
\usepackage{coseoul}
% used to revert to sub-document's top level
\newcounter{baseSectionLevel}
%-------------------------------------------------------------------------------
% layout file determines 1/2 col, landscape/portrait...
\usepackage{geometry}
%-------------------------------------------------------------------------------
\usepackage{color}
\usepackage[dvipsnames,svgnames,x11names]{xcolor}
%-------------------------------------------------------------------------------
\usepackage{graphics}
\usepackage{epsfig}
\usepackage{graphicx}
\PassOptionsToPackage{normalem}{ulem}
\usepackage{ulem}
%-------------------------------------------------------------------------------
% category thgeory
\usepackage{tikz-cd}
%\usepackage{tikz-network}
%-------------------------------------------------------------------------------
\usepackage{url}
%-------------------------------------------------------------------------------
\usepackage[utf8x]{inputenc}
\usepackage{csquotes}
%-------------------------------------------------------------------------------
\usepackage[english]{babel}
%-------------------------------------------------------------------------------
\usepackage{epigraph}
\setlength{\epigraphwidth}{0.9\linewidth}
\renewcommand{\epigraphflush}{center}
\renewcommand{\sourceflush}{flushleft}

%-------------------------------------------------------------------------------
\usepackage{fontspec}
%-------------------------------------------------------------------------------
%\setmainfont{Baskerville Old Face}
%\setmainfont{Libre Caslon Text}[Scale=0.85]
%\setmainfont{Centaur}
%\setmainfont{Garamond}
%\setmainfont{Georgia}
%\setmainfont{Perpetua}
%\setmainfont{Poor Richard}

% http://www.impallari.com/projects/overview/libre-caslon-display-and-text
%\setmainfont{Libre Caslon Text}[Scale=0.85]
%\newfontfamily\scshape[Letters=SmallCaps,Scale=1.15]{Crimson}

% http://iginomarini.com/fell/the-revival-fonts/
% \fontspec[
%  SmallCapsFont=IM FELL English SC,
%  SmallCapsFeatures={Letters=SmallCaps},
% ]{IM FELL English}
% \setmainfont{IM FELL English}
 
% https://github.com/CatharsisFonts/Cormorant/releases/tag/v3.3 

% http://www.georgduffner.at/ebgaramond/download.html
% \fontspec[
%  SmallCapsFeatures={Letters=SmallCaps},
% ]{EB Garamond}
\setmainfont[
Path,
UprightFont = *12-Regular,
ItalicFont  = *12-Italic,
BoldFont    = *08-Regular,
BoldItalicFont = *08-Italic ]
{EBGaramond}

% https://www.microsoft.com/typography/fonts/family.aspx?FID=134
% \fontspec[
%  SmallCapsFeatures={Letters=SmallCaps},
% ]{Garamond}
% \setmainfont{Garamond}
%\setmainfont{Palatino Linotype}
%\setmainfont{Perpetua}[Scale=1.1]
%\setmainfont{Times New Roman}
%-------------------------------------------------------------------------------
% https://www.microsoft.com/typography/fonts/family.aspx?FID=155
\setsansfont{Gill Sans MT} 

% http://arkandis.tuxfamily.org/adffonts.html
% \setsansfont{Gillius ADF}
%-------------------------------------------------------------------------------
% \usepackage{xeCJK}
% \setCJKmainfont{SimHei}
% \setCJKsansfont{SimHei}
% \setCJKmonofont{Lucida Sans Typewriter}
%-------------------------------------------------------------------------------
\usepackage{amsmath}
\usepackage{amssymb}
\DeclareMathOperator*{\argmin}{argmin}
\DeclareMathOperator*{\argmax}{argmax}
\DeclareMathOperator*{\sign}{sign}
\DeclareMathOperator*{\defeq}
{\overset{\underset{\mathrm{def}}{}}{=}}
%\DeclareMathOperator*{\cdf}{cdf}
%\DeclareMathOperator*{\quantile}{quantile}
\newcommand\bigforall{\mbox{\Large $\mathsurround0pt\forall$}} 
% https://tex.stackexchange.com/questions/14071/how-can-i-increase-the-line-spacing-in-a-matrix
\makeatletter
\renewcommand*\env@matrix[1][\arraystretch]{%
  \edef\arraystretch{#1}%
  \hskip -\arraycolsep
  \let\@ifnextchar\new@ifnextchar
  \array{*\c@MaxMatrixCols c}}
\makeatother
% https://tex.stackexchange.com/questions/42726/align-but-show-one-equation-number-at-the-end/42728#42728
\newcommand\numberthis{\addtocounter{equation}{1}\tag{\theequation}}
%-----------------------------------------------------------------
\usepackage{mathtools}
%-----------------------------------------------------------------
%\usepackage[amsthm,amsmath]{ntheorem}
\usepackage{amsthm}
\usepackage{thmtools}
%-----------------------------------------------------------------
\newtheoremstyle{break}%
{3pt}{3pt}%
{}{}%
{\bfseries}%
{}% % Note that final punctuation is omitted.
{\newline}%
{\thmname{#1}\thmnumber{ #2}\thmnote{ #3}}

\theoremstyle{break}
\newtheorem{definition}{\textsc{Definition}}[section]

\theoremstyle{definition}
\newtheorem{theorem}{\textsc{Theorem}}[section]
\theoremstyle{definition}
\newtheorem{example}{\textsc{Example}}[section]

%-----------------------------------------------------------------
% \numberwithin{theorem}{chapter}
% \numberwithin{definition}{chapter}
% \numberwithin{example}{chapter}
% \numberwithin{equation}{chapter}
% \numberwithin{figure}{chapter}
\numberwithin{theorem}{section}
\numberwithin{definition}{section}
\numberwithin{example}{section}
\numberwithin{equation}{section}
\numberwithin{figure}{section}
%-----------------------------------------------------------------
\usepackage{listings}
\lstset{backgroundcolor={\color{GhostWhite}},
basicstyle={\ttfamily\small},
breaklines=false,
captionpos=b,
%frame=tblr,
mathescape=true,
escapechar=\%,
keywordstyle={\ttfamily}}
%\renewcommand{\lstlistingname}{Listing}
%\renewcommand{\lstlistingname}{}
% \providecommand{\algorithmname}{Algorithm}
% \providecommand{\exercisename}{Exercise}
% \providecommand{\theoremname}{Theorem}
% \providecommand{\examplename}{Example}
%-----------------------------------------------------------------
\usepackage{algpseudocode,algorithm,algorithmicx}
%-----------------------------------------------------------------
\usepackage{datetime}
\renewcommand{\dateseparator}{-}
\renewcommand{\today}{
\the\year \dateseparator \twodigit\month \dateseparator \twodigit\day}
%-----------------------------------------------------------------
\setlength{\parskip}{5pt}
\setlength{\parindent}{0pt}
\usepackage[parfill]{parskip}
%-----------------------------------------------------------------
% \usepackage{fancyhdr}
% \pagestyle{fancy}
% \setlength{\headwidth}{\textheight}
% \addtolength{\headwidth}{\columnsep}
% %\addtolength{\headwidth}{\marginparsep}
% %\addtolength{\headwidth}{\marginparwidth}
% \fancypagestyle{plain}{
% \fancyhead{} % clear all head fields 
% \fancyfoot{} % clear all foot fields
% \fancyfoot[RO,LE]{\textsf{\thepage}} 
% \fancyfoot[RE,LO]{\textsf{Draft of \today}}
% \renewcommand{\headrulewidth}{0.0pt}
% \renewcommand{\footrulewidth}{0.1pt}}
% \pagestyle{plain}
%-----------------------------------------------------------------
\usepackage{titling}
%\newfontfamily\titlefont[Scale=MatchUppercase]{Gill Sans MT}
%\renewcommand{\maketitlehooka}{\titlefont}
%\pretitle{\begin{flushright}\Huge\sffamily\bfseries}
\pretitle{\begin{flushright}\Huge\scshape\bfseries}
\posttitle{\par\end{flushright}\vskip 0.25em}
%\preauthor{\begin{flushright}\sffamily\scshape\mdseries}
\preauthor{\begin{flushright}\scshape\mdseries}
\postauthor{\par\end{flushright}}
%\predate{\begin{flushright}\sffamily\scshape\mdseries}
\predate{\begin{flushright}\scshape\mdseries}
\postdate{\par\end{flushright}}
\setlength{\droptitle}{-80pt}
%-----------------------------------------------------------------
\usepackage{enumitem}
%\setlist[description]{font=\small\sffamily\mdseries,style=unboxed,leftmargin=0cm}
%\setlist[description]{font=\sffamily\mdseries}
\setlist[description]{font=\scshape\bfseries}
\setlist[itemize]{style=unboxed,itemindent=0cm}
\setlist[enumerate]{style=unboxed,itemindent=0cm}
%-----------------------------------------------------------------
%\usepackage[sf,small,compact]{titlesec}
\usepackage[pagestyles,small,compact,sc,rigidchapters]{titlesec}
%\newfontfamily\headingfont[]{New Yorker}
%\newfontfamily\headingfont[Scale=MatchUppercase]{Libre Caslon Display}
%\newfontfamily\headingfont[]{Perpetua Titling MT}
%\newfontfamily\headingfont[Scale=MatchUppercase]{Gill Sans MT}
%\newfontfamily\headingfont[Scale=MatchUppercase]{Gillius ADF}

% \titleformat{\part}{\huge\sffamily\bfseries}{\thepart}{0.5em}{}
% \titleformat{\chapter}{\LARGE\sffamily\bfseries}{\thechapter}{0.5em}{}
% \titleformat{\section}{\Large\sffamily\bfseries}{\thesection}{0.5em}{}
% \titleformat{\subsection}{\large\sffamily\bfseries}{\thesubsection}{0.5em}{}
% \titleformat{\subsubsection}{\large\sffamily\mdseries}{\thesubsubsection}{0.5em}{}
% \titleformat{\paragraph}[runin]{\normalsize\sffamily\mdseries}{\theparagraph}{0.5em}{}[\hspace{1em}]
% \titleformat{\subparagraph}[runin]{\normalsize\sffamily\mdseries}{\thesubparagraph}{0.5em}{}[\hspace{1em}]

\titleformat{\part}{\huge\scshape\bfseries}{\thepart}{0.5em}{}
\titleformat{\chapter}{\LARGE\scshape\bfseries}{\thechapter}{0.5em}{}
%\titleformat{name=\chapter*,numberless}{\LARGE\scshape\bfseries}{\thechapter}{0.5em}{}
\titleformat{\section}{\Large\scshape\bfseries}{\thesection}{0.5em}{}
\titleformat{\subsection}{\large\scshape\bfseries}{\thesubsection}{0.5em}{}
\titleformat{\subsubsection}{\large\scshape\mdseries}{\thesubsubsection}{0.5em}{}
\titleformat{\paragraph}[runin]{\normalsize\scshape\mdseries}{\theparagraph}{0.5em}{}[\hspace{1em}]
\titleformat{\subparagraph}[runin]{\normalsize\scshape\mdseries}{\thesubparagraph}{0.5em}{}[\hspace{1em}]
%\titlespacing\chapter{0pt}{12pt plus 12pt minus 2pt}{5pt plus 5pt minus 2pt}
\titlespacing\section{0pt}{12pt plus 12pt minus 2pt}{5pt plus 5pt minus 2pt}
\titlespacing\subsection{0pt}{11pt plus 11pt minus 2pt}{5pt plus 5pt minus 2pt}
\titlespacing\subsubsection{0pt}{10pt plus 10pt minus 2pt}{5pt plus 5pt minus 2pt}
\newcommand{\chapterbreak}{\vfill\clearpage}
\setcounter{secnumdepth}{7}
%-----------------------------------------------------------------
\renewpagestyle{plain}{
\sethead[][\scshape\chaptertitle][] % even
{} {\scshape\chaptertitle} {} % odd
\setfoot[][\thepage][] % even
{}{\thepage}{} % odd
}
\newpagestyle{front}{
\sethead[][\scshape\chaptertitle][] % even
{} {\scshape\chaptertitle} {} % odd
\setfoot[][\thepage][] % even
{}{\thepage}{} % odd
}
\newpagestyle{back}{
\sethead[][\scshape\chaptertitle][] % even
{} {\scshape\chaptertitle}{} % odd
\setfoot[][\thepage][] % even
{}{\thepage}{} % odd
}
\renewpagestyle{empty}{
\sethead[][][] % even
{} {} {}% odd
}
\pagestyle{empty}
%-----------------------------------------------------------------
\makeatletter
\let\oldl@chapter\l@chapter
\def\l@chapter#1#2{\oldl@chapter{#1}{\textrm{#2}}}
\let\old@dottedcontentsline\@dottedtocline
\def\@dottedtocline#1#2#3#4#5{%
\old@dottedcontentsline{#1}{#2}{#3}{#4}{{\textrm{#5}}}}
\makeatother
%-----------------------------------------------------------------
%https://en.wikibooks.org/wiki/LaTeX/Indexing
\usepackage{makeidx}
\makeindex
\usepackage[totoc]{idxlayout}
%-----------------------------------------------------------------
\usepackage[
backend=biber, 
citestyle=numeric-comp, 
bibstyle=numeric,
%bibstyle=verbose,
%entrykey=false,
labelnumber=true,
sortcites=true,
maxnames=1000,
maxitems=1000,
block=nbpar,
abbreviate=false,
seconds=true,
date=iso,
alldates=iso,
datezeros=true,
timezeros=true,
]{biblatex} 
\renewcommand\mkbibnamefamily[1]{\textsc{#1}}
%-----------------------------------------------------------------
% \usepackage[chapter]{tocbibind}
% \renewcommand{\listfigurename}{Figures}
% \setlofname{Figures}
% \renewcommand{\listoffigures}{\begingroup
% \tocchapter
% \tocfile{\listfigurename}{lof}
% \endgroup}
%-----------------------------------------------------------------
%\usepackage[titletoc]{appendix}
%-----------------------------------------------------------------
\usepackage[unicode=true,
pdfusetitle,
bookmarks=true,
bookmarksnumbered=false,
bookmarksopen=true,
bookmarksopenlevel=1,
breaklinks=false,
pdfborder={0 0 0},
pdftoolbar=false,
pdffitwindow=true,
backref=false,
colorlinks=true]{hyperref}
\hypersetup{unicode=true,
colorlinks=true,
pdfpagemode=UseOutlines,
pdfpagelayout=OneColumn,
pdfstartview=Fit,
linkcolor=MidnightBlue,
urlcolor=Mahogany,
citecolor=OliveGreen}
\usepackage{bookmark}
%-----------------------------------------------------------------
% \usepackage[xindy,toc,style=alttreehypergroup,nolong,nosuper]{glossaries}
%-----------------------------------------------------------------
% doesn't do much for XeTeX
%\usepackage{microtype}
%-----------------------------------------------------------------
\input{symbols}
%-----------------------------------------------------------------
% multipage quotes in boxes
\usepackage[framemethod=tikz]{mdframed}
\usepackage[most]{tcolorbox}
\usepackage{chngcntr}
\usetikzlibrary{calc}

\newlength\CapHt
\newlength\CapDp

\newtcolorbox{boxquote}[0]{%
spartan,
breakable,
enhanced,
freelance,
%frame code = {},
colframe=GhostWhite,
% frame code={
%   \draw[line width=0pt]
%     ([yshift=1pt]interior.north west-|frame.north west) --
%     ([yshift=1pt]interior.north east-|frame.north east) --
%     (frame.south east) --
%     (frame.south west) --
%     cycle;
%   },
colback=GhostWhite,
top=4mm,
arc=0pt,
outer arc=0pt,
pad at break=2mm,
fontupper=\normalsize,
notitle,
fontlower=\normalfont\small,
overlay middle={%
  \node[
    inner xsep=0pt,
    anchor=north east,
    font=\footnotesize\color{DarkGray}]
  at (frame.south east) {cont.};
  },
overlay first={%
  \node[
    inner xsep=0pt,
    anchor=north east,
    font=\footnotesize\color{DarkGray}]
  at (frame.south east) {cont.};
  },
% enlarge top by=\topskip,
% enlarge top at break by=0pt,
% enlarge bottom at break by=\baselineskip,
% attach boxed title to bottom left={yshift=2pt},
%   boxed title style={
%     enhanced,
%     arc=0pt,
%     outer arc=0pt,
%   },
%   boxed title style={size=small,colback=Cornsilk}
}
% \makeatletter
% % add tcblistings to \jobname.lol (list of listings)
% \tcbset{
%   addtolol/.style={list entry={\kvtcb@title},add to list={lol}{section}},
%   }
% \makeatother

\newtcbtheorem[
number within=section,
list inside={tcbdef}]
{tcbdefinition}
{Definition}%
{spartan,
breakable,
enhanced,
freelance,
colback=GhostWhite,
colframe=GhostWhite,
coltitle=black,
fonttitle=\scshape\bfseries}
{def}
%
